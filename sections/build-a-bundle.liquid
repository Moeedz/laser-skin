{% comment %}
  8x8 Facial Treatment Bundle - Skin Type Filtered
  - Select skin type first
  - Choose 1 treatment from each of 8 buckets
  - Fixed price: $99.99 for 8 treatments
{% endcomment %}

<div class="facial-bundle" data-section-id="{{ section.id }}">
  <div class="bundle-container">
    {% if section.settings.section_title != blank %}
      <h2 class="bundle-title">{{ section.settings.section_title }}</h2>
    {% endif %}
    
    {% if section.settings.section_description != blank %}
      <div class="bundle-description">{{ section.settings.section_description }}</div>
    {% endif %}

    <!-- Skin Type Selector -->
    <div class="skin-type-selector">
      <h3 class="selector-title">Select Your Skin Type</h3>
      <div class="skin-type-options">
        <label class="skin-type-option">
          <input type="radio" name="skin_type" value="Normal" class="skin-type-radio">
          <span class="skin-type-label">Normal</span>
        </label>
        <label class="skin-type-option">
          <input type="radio" name="skin_type" value="Dry" class="skin-type-radio">
          <span class="skin-type-label">Dry</span>
        </label>
        <label class="skin-type-option">
          <input type="radio" name="skin_type" value="Oily" class="skin-type-radio">
          <span class="skin-type-label">Oily</span>
        </label>
        <label class="skin-type-option">
          <input type="radio" name="skin_type" value="Combination" class="skin-type-radio">
          <span class="skin-type-label">Combination</span>
        </label>
        <label class="skin-type-option">
          <input type="radio" name="skin_type" value="Sensitive" class="skin-type-radio">
          <span class="skin-type-label">Sensitive</span>
        </label>
      </div>
    </div>

    <!-- Treatment Selection Notice -->
    <div class="selection-notice" id="selectionNotice" style="display: none;">
      <p>Please select <strong>1 treatment</strong> from each of the <strong>8 categories</strong> below to build your custom facial bundle.</p>
    </div>

    <!-- Progress Tracker -->
    <div class="bundle-progress" id="progressSection" style="display: none;">
      <div class="progress-info">
        <span class="progress-label">Bundle Progress:</span>
        <span class="progress-count" id="progressCount">0 / 8 treatments selected</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
    </div>

    <!-- Treatment Categories -->
    <div class="treatment-categories" id="treatmentCategories" style="display: none;">
      
      <!-- Category 1: Cleanse & Prep -->
      <div class="category-wrapper" data-bucket="Cleanse & Prep">
        <div class="category-header">
          <div class="category-title-wrapper">
            <span class="category-number">1</span>
            <h3 class="category-title">Cleanse & Prep</h3>
          </div>
          <div class="category-right">
            <span class="category-status">Not selected</span>
            <span class="expand-icon">â–¼</span>
          </div>
        </div>
        
        <div class="category-options">
          <!-- Treatments will be populated by JavaScript based on skin type -->
        </div>
      </div>

      <!-- Category 2: Exfoliate & Refine -->
      <div class="category-wrapper" data-bucket="Exfoliate & Refine">
        <div class="category-header">
          <div class="category-title-wrapper">
            <span class="category-number">2</span>
            <h3 class="category-title">Exfoliate & Refine</h3>
          </div>
          <div class="category-right">
            <span class="category-status">Not selected</span>
            <span class="expand-icon">â–¼</span>
          </div>
        </div>
        
        <div class="category-options">
          <!-- Treatments will be populated by JavaScript -->
        </div>
      </div>

      <!-- Category 3: Detox & Clarify -->
      <div class="category-wrapper" data-bucket="Detox & Clarify">
        <div class="category-header">
          <div class="category-title-wrapper">
            <span class="category-number">3</span>
            <h3 class="category-title">Detox & Clarify</h3>
          </div>
          <div class="category-right">
            <span class="category-status">Not selected</span>
            <span class="expand-icon">â–¼</span>
          </div>
        </div>
        
        <div class="category-options">
          <!-- Treatments will be populated by JavaScript -->
        </div>
      </div>

      <!-- Category 4: Extract & Clear -->
      <div class="category-wrapper" data-bucket="Extract & Clear">
        <div class="category-header">
          <div class="category-title-wrapper">
            <span class="category-number">4</span>
            <h3 class="category-title">Extract & Clear</h3>
          </div>
          <div class="category-right">
            <span class="category-status">Not selected</span>
            <span class="expand-icon">â–¼</span>
          </div>
        </div>
        
        <div class="category-options">
          <!-- Treatments will be populated by JavaScript -->
        </div>
      </div>

      <!-- Category 5: Boost & Infuse -->
      <div class="category-wrapper" data-bucket="Boost & Infuse">
        <div class="category-header">
          <div class="category-title-wrapper">
            <span class="category-number">5</span>
            <h3 class="category-title">Boost & Infuse</h3>
          </div>
          <div class="category-right">
            <span class="category-status">Not selected</span>
            <span class="expand-icon">â–¼</span>
          </div>
        </div>
        
        <div class="category-options">
          <!-- Treatments will be populated by JavaScript -->
        </div>
      </div>

      <!-- Category 6: Calm & Balance -->
      <div class="category-wrapper" data-bucket="Calm & Balance">
        <div class="category-header">
          <div class="category-title-wrapper">
            <span class="category-number">6</span>
            <h3 class="category-title">Calm & Balance</h3>
          </div>
          <div class="category-right">
            <span class="category-status">Not selected</span>
            <span class="expand-icon">â–¼</span>
          </div>
        </div>
        
        <div class="category-options">
          <!-- Treatments will be populated by JavaScript -->
        </div>
      </div>

      <!-- Category 7: Activate & Repair -->
      <div class="category-wrapper" data-bucket="Activate & Repair">
        <div class="category-header">
          <div class="category-title-wrapper">
            <span class="category-number">7</span>
            <h3 class="category-title">Activate & Repair</h3>
          </div>
          <div class="category-right">
            <span class="category-status">Not selected</span>
            <span class="expand-icon">â–¼</span>
          </div>
        </div>
        
        <div class="category-options">
          <!-- Treatments will be populated by JavaScript -->
        </div>
      </div>

      <!-- Category 8: Seal & Protect -->
      <div class="category-wrapper" data-bucket="Seal & Protect">
        <div class="category-header">
          <div class="category-title-wrapper">
            <span class="category-number">8</span>
            <h3 class="category-title">Seal & Protect</h3>
          </div>
          <div class="category-right">
            <span class="category-status">Not selected</span>
            <span class="expand-icon">â–¼</span>
          </div>
        </div>
        
        <div class="category-options">
          <!-- Treatments will be populated by JavaScript -->
        </div>
      </div>

    </div>

    <!-- Appointment Picker -->
    <div class="appointment-picker-section" id="appointmentSection" style="display: none;">
      <h3 class="appointment-title">Select Your Appointment Date & Time</h3>
      <div class="appointment-dropdown" id="appointmentDropdown">
        <span id="appointmentDisplay">Choose appointment date and time</span>
        <span class="appointment-dropdown-icon">â–¼</span>
      </div>

      <!-- Appointment Modal -->
      <div class="appointment-modal" id="appointmentModal">
        <div class="appointment-modal-content">
          <div class="appointment-modal-header">
            <div class="appointment-modal-title">ðŸ“… Select Date and Time</div>
            <button class="appointment-modal-close" id="closeModal">&times;</button>
          </div>
          <div class="appointment-modal-body">
            <div class="calendar-header">
              <button type="button" class="calendar-nav-btn" id="prevMonth">â€¹</button>
              <div class="calendar-month-year" id="monthYear"></div>
              <button type="button" class="calendar-nav-btn" id="nextMonth">â€º</button>
            </div>
            <div class="calendar-weekdays">
              <div class="calendar-weekday">Mon</div>
              <div class="calendar-weekday">Tue</div>
              <div class="calendar-weekday">Wed</div>
              <div class="calendar-weekday">Thu</div>
              <div class="calendar-weekday">Fri</div>
              <div class="calendar-weekday">Sat</div>
              <div class="calendar-weekday">Sun</div>
            </div>
            <div class="calendar-dates" id="calendarDates"></div>
            <div class="time-panel-header" id="timeHeader">Select a date first</div>
            <div class="time-slots-scroll" id="timeSlots"></div>
          </div>
          <div class="appointment-modal-footer">
            <button class="appointment-btn appointment-btn-cancel" id="cancelBtn">Cancel</button>
            <button class="appointment-btn appointment-btn-confirm" id="confirmBtn" disabled>Confirm</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bundle Footer -->
    <div class="bundle-footer" id="bundleFooter" style="display: none;">
      <div class="bundle-pricing">
        <div class="price-display">
          <span class="price-label">Total Price:</span>
          <span class="price-amount">$99.99</span>
        </div>
        <div class="selections-info" id="selectionsInfo">Complete your bundle to proceed</div>
      </div>

      <button 
        type="button" 
        class="bundle-add-to-cart"
        id="addToCartBtn"
        disabled
      >
        Add Bundle to Cart
      </button>
    </div>
  </div>
</div>

<style>
/* 
  STICKY PROGRESS BAR SETUP:
  If the progress bar overlaps your header, adjust these values:
  - Desktop: Change "top: 80px" to your header height + 10px
  - Mobile: Change "top: 60px" to your mobile header height + 10px
*/

.facial-bundle {
  max-width: 1200px;
  margin: 0 auto;
  padding: 40px 20px;
}

.bundle-container {
  background: #fff;
  border-radius: 12px;
  padding: 40px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.08);
}

.bundle-title {
  font-size: 36px;
  font-weight: 700;
  text-align: center;
  margin-bottom: 15px;
  color: #1a1a1a;
}

.bundle-description {
  text-align: center;
  color: #666;
  margin-bottom: 40px;
  font-size: 16px;
  line-height: 1.6;
}

/* Skin Type Selector */
.skin-type-selector {
  margin-bottom: 40px;
  padding: 30px;
  background: #f8f8f8;
  border-radius: 12px;
  text-align: center;
}

.selector-title {
  font-size: 24px;
  font-weight: 600;
  margin-bottom: 25px;
  color: #1a1a1a;
}

.skin-type-options {
  display: flex;
  gap: 15px;
  justify-content: center;
  flex-wrap: wrap;
}

.skin-type-option {
  position: relative;
  cursor: pointer;
}

.skin-type-radio {
  position: absolute;
  opacity: 0;
  cursor: pointer;
}

.skin-type-label {
  display: block;
  padding: 15px 30px;
  background: white;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 500;
  color: #333;
  transition: all 0.3s ease;
  min-width: 140px;
  text-align: center;
}

.skin-type-option:hover .skin-type-label {
  border-color: #4CAF50;
  background: #f0f9f0;
}

.skin-type-radio:checked ~ .skin-type-label {
  background: #4CAF50;
  color: white;
  border-color: #4CAF50;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
}

/* Selection Notice */
.selection-notice {
  text-align: center;
  padding: 20px;
  background: #e3f2fd;
  border-radius: 8px;
  margin-bottom: 30px;
  border-left: 4px solid #2196F3;
}

.selection-notice p {
  margin: 0;
  color: #1565C0;
  font-size: 15px;
}

/* Progress Tracker */
.bundle-progress {
  margin-bottom: 35px;
  padding: 25px;
  background: #ffffff;
  border-radius: 10px;
  position: sticky;
  top: 80px;
  z-index: 100;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
  border: 2px solid #e0e0e0;
}

.bundle-progress.scrolled {
  box-shadow: 0 4px 16px rgba(0,0,0,0.2);
  background: #f8fef8;
  border-color: #4CAF50;
}

.progress-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.progress-label {
  font-size: 16px;
  font-weight: 600;
  color: #333;
}

.progress-count {
  font-size: 14px;
  color: #666;
  font-weight: 500;
}

.progress-bar {
  width: 100%;
  height: 12px;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: visible;
  position: relative;
  display: block;
}

.progress-fill {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  background: linear-gradient(90deg, #4CAF50 0%, #45a049 100%);
  width: 0%;
  transition: width 0.4s ease;
  border-radius: 10px;
  display: block;
  will-change: width;
}

/* Treatment Categories */
.treatment-categories {
  display: grid;
  gap: 20px;
  margin-bottom: 30px;
}

.category-wrapper {
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  padding: 0;
  transition: all 0.3s ease;
  background: white;
}

.category-wrapper.completed {
  border-color: #4CAF50;
  background: #f9fff9;
}

.category-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 25px;
  cursor: pointer;
  user-select: none;
  transition: background 0.2s ease;
  border-bottom: 2px solid #e0e0e0;
}

.category-header:hover {
  background: rgba(76, 175, 80, 0.05);
}

.category-title-wrapper {
  display: flex;
  align-items: center;
  gap: 15px;
}

.category-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  background: #4CAF50;
  color: white;
  border-radius: 50%;
  font-size: 16px;
  font-weight: 700;
  flex-shrink: 0;
}

.category-title {
  font-size: 20px;
  font-weight: 600;
  color: #1a1a1a;
  margin: 0;
}

.category-right {
  display: flex;
  align-items: center;
  gap: 15px;
}

.category-status {
  font-size: 14px;
  color: #999;
  font-weight: 500;
}

.category-wrapper.completed .category-status {
  color: #4CAF50;
  font-weight: 600;
}

.expand-icon {
  font-size: 16px;
  transition: transform 0.3s ease;
  color: #666;
}

.category-wrapper.collapsed .expand-icon {
  transform: rotate(-90deg);
}

.category-options {
  padding: 20px 25px;
  display: grid;
  gap: 12px;
  max-height: 2000px;
  overflow: hidden;
  transition: max-height 0.4s ease, opacity 0.3s ease, padding 0.3s ease;
  opacity: 1;
}

.category-wrapper.collapsed .category-options {
  max-height: 0;
  opacity: 0;
  padding-top: 0;
  padding-bottom: 0;
}

.treatment-option {
  display: flex;
  align-items: flex-start;
  padding: 16px 18px;
  background: #f8f8f8;
  border: 2px solid transparent;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
}

.treatment-option:hover {
  background: #f0f0f0;
  border-color: #4CAF50;
  transform: translateX(4px);
}

.treatment-radio {
  position: absolute;
  opacity: 0;
  cursor: pointer;
}

.treatment-content {
  flex: 1;
  padding-left: 0;
}

.treatment-name {
  font-size: 15px;
  font-weight: 600;
  color: #333;
  margin-bottom: 6px;
  display: block;
}

.treatment-description {
  font-size: 13px;
  color: #666;
  line-height: 1.5;
  margin: 0;
}

.treatment-checkmark {
  display: none;
  width: 24px;
  height: 24px;
  background: #4CAF50;
  color: white;
  border-radius: 50%;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 700;
  flex-shrink: 0;
  margin-left: 12px;
}

.treatment-radio:checked ~ .treatment-checkmark {
  display: flex;
}

.treatment-radio:checked ~ .treatment-content .treatment-name {
  color: #4CAF50;
}

.treatment-option:has(.treatment-radio:checked) {
  background: #e8f5e9;
  border-color: #4CAF50;
}

/* Bundle Footer */
.bundle-footer {
  background: #f8f8f8;
  padding: 30px;
  border-radius: 12px;
  margin-top: 30px;
}

.bundle-pricing {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.price-display {
  display: flex;
  align-items: center;
  gap: 12px;
}

.price-label {
  font-size: 18px;
  color: #666;
  font-weight: 500;
}

.price-amount {
  font-size: 36px;
  font-weight: 700;
  color: #4CAF50;
}

.selections-info {
  font-size: 14px;
  color: #666;
  font-weight: 500;
}

.bundle-add-to-cart {
  width: 100%;
  padding: 18px 32px;
  font-size: 18px;
  font-weight: 600;
  background: #4CAF50;
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.bundle-add-to-cart:hover:not(:disabled) {
  background: #45a049;
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(76, 175, 80, 0.3);
}

.bundle-add-to-cart:disabled {
  background: #ccc;
  cursor: not-allowed;
  opacity: 0.6;
}

/* Appointment Picker Styles */
.appointment-picker-section {
  margin: 30px 0;
  padding: 30px;
  background: #f8f8f8;
  border-radius: 12px;
}

.appointment-title {
  font-size: 24px;
  font-weight: 600;
  margin-bottom: 20px;
  color: #1a1a1a;
  text-align: center;
}

.appointment-dropdown {
  width: 100%;
  padding: 16px 20px;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  background: white;
  font-size: 16px;
  color: #333;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  transition: all 0.2s;
}

.appointment-dropdown:hover {
  border-color: #4CAF50;
  background: #f9fff9;
}

.appointment-dropdown-icon {
  transition: transform 0.3s;
  color: #666;
}

.appointment-dropdown.active .appointment-dropdown-icon {
  transform: rotate(180deg);
}

.appointment-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  z-index: 9999;
  align-items: center;
  justify-content: center;
}

.appointment-modal.active {
  display: flex;
}

.appointment-modal-content {
  background: white;
  border-radius: 12px;
  max-width: 500px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
}

.appointment-modal-header {
  padding: 20px 25px;
  border-bottom: 2px solid #eee;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: #f8f8f8;
}

.appointment-modal-title {
  font-size: 20px;
  font-weight: 600;
  color: #1a1a1a;
}

.appointment-modal-close {
  background: none;
  border: none;
  font-size: 28px;
  color: #999;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  line-height: 1;
  transition: color 0.2s;
}

.appointment-modal-close:hover {
  color: #333;
}

.appointment-modal-body {
  padding: 25px;
}

.calendar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
}

.calendar-nav-btn {
  background: #f5f5f5;
  border: 1px solid #e0e0e0;
  cursor: pointer;
  padding: 8px 14px;
  font-size: 22px;
  border-radius: 6px;
  min-width: 44px;
  transition: all 0.2s;
}

.calendar-nav-btn:hover {
  background: #4CAF50;
  color: white;
  border-color: #4CAF50;
}

.calendar-month-year {
  font-size: 18px;
  font-weight: 700;
  color: #1a1a1a;
}

.calendar-weekdays {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 8px;
  margin-bottom: 10px;
}

.calendar-weekday {
  text-align: center;
  font-size: 13px;
  font-weight: 600;
  color: #666;
  padding: 8px 0;
}

.calendar-dates {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 8px;
  margin-bottom: 25px;
}

.calendar-date {
  aspect-ratio: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 15px;
  font-weight: 500;
  cursor: pointer;
  border-radius: 50%;
  transition: all 0.2s;
  border: 2px solid transparent;
  min-height: 42px;
}

.calendar-date:hover:not(.disabled):not(.past) {
  background: #f0f9f0;
  border-color: #4CAF50;
}

.calendar-date.selected {
  background: #4CAF50;
  color: white;
  transform: scale(1.05);
}

.calendar-date.today {
  border-color: #4CAF50;
  font-weight: 700;
}

.calendar-date.disabled {
  color: #ccc;
  cursor: not-allowed;
  text-decoration: line-through;
}

.calendar-date.past {
  color: #ddd;
  cursor: not-allowed;
}

.time-panel-header {
  background: #4CAF50;
  color: white;
  padding: 14px 18px;
  text-align: center;
  font-size: 15px;
  font-weight: 600;
  border-radius: 8px 8px 0 0;
}

.time-slots-scroll {
  border: 2px solid #e0e0e0;
  border-top: none;
  border-radius: 0 0 8px 8px;
  max-height: 280px;
  overflow-y: auto;
  padding: 10px;
  background: #fafafa;
}

.time-slot-option {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 14px;
  margin-bottom: 6px;
  cursor: pointer;
  border-radius: 6px;
  background: white;
  border: 2px solid transparent;
  transition: all 0.2s;
}

.time-slot-option:hover {
  background: #f0f9f0;
  border-color: #4CAF50;
}

.time-slot-option.selected {
  background: #e8f5e9;
  border-color: #4CAF50;
}

.time-slot-radio {
  width: 22px;
  height: 22px;
  border: 2px solid #D1D5DB;
  border-radius: 50%;
  position: relative;
  transition: all 0.2s;
}

.time-slot-option.selected .time-slot-radio {
  border-color: #4CAF50;
}

.time-slot-option.selected .time-slot-radio::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 12px;
  height: 12px;
  background: #4CAF50;
  border-radius: 50%;
}

.appointment-modal-footer {
  padding: 20px 25px;
  border-top: 2px solid #eee;
  display: flex;
  gap: 12px;
  background: #f8f8f8;
  position: sticky;
  bottom: 0;
  z-index: 10;
}

.appointment-btn {
  flex: 1;
  padding: 14px 28px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.appointment-btn-cancel {
  background: white;
  color: #666;
  border: 2px solid #e0e0e0;
}

.appointment-btn-cancel:hover {
  background: #f5f5f5;
  border-color: #999;
}

.appointment-btn-confirm {
  background: #4CAF50;
  color: white;
}

.appointment-btn-confirm:hover:not(:disabled) {
  background: #45a049;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
}

.appointment-btn-confirm:disabled {
  background: #ccc;
  cursor: not-allowed;
  opacity: 0.6;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .facial-bundle {
    padding: 20px 15px;
  }

  .bundle-container {
    padding: 25px 20px;
  }

  .bundle-title {
    font-size: 28px;
  }

  .selector-title {
    font-size: 20px;
  }

  .skin-type-options {
    gap: 10px;
  }

  .skin-type-label {
    padding: 12px 20px;
    font-size: 14px;
    min-width: 120px;
  }

  .category-header {
    padding: 15px 18px;
  }

  .category-title {
    font-size: 18px;
  }

  .category-number {
    width: 32px;
    height: 32px;
    font-size: 14px;
  }

  .category-options {
    padding: 15px 18px;
  }

  .treatment-option {
    padding: 14px 16px;
  }

  .treatment-name {
    font-size: 14px;
  }

  .treatment-description {
    font-size: 12px;
  }

  .bundle-pricing {
    flex-direction: column;
    gap: 15px;
    align-items: flex-start;
  }

  .price-amount {
    font-size: 30px;
  }

  .bundle-add-to-cart {
    font-size: 16px;
    padding: 16px 24px;
  }

  .bundle-footer {
    padding: 20px;
  }
  
  .bundle-progress {
    padding: 15px;
    margin-bottom: 20px;
    top: 60px;
    border-radius: 0 0 8px 8px;
    font-size: 14px;
  }
  
  .progress-info {
    flex-direction: column;
    gap: 6px;
    align-items: flex-start;
  }
  
  .progress-label {
    font-size: 14px;
  }
  
  .progress-count {
    font-size: 13px;
  }
  
  .progress-bar {
    height: 10px;
  }
  
  .appointment-picker-section {
    padding: 20px;
  }

  .appointment-title {
    font-size: 20px;
  }

  .appointment-dropdown {
    padding: 14px 16px;
    font-size: 14px;
  }

  .appointment-modal-content {
    width: 95%;
  }

  .appointment-modal-header {
    padding: 16px 18px;
  }

  .appointment-modal-title {
    font-size: 18px;
  }

  .appointment-modal-body {
    padding: 18px;
  }

  .time-slots-scroll {
    max-height: 200px;
  }

  .appointment-modal-footer {
    padding: 16px 18px;
  }

  .appointment-btn {
    padding: 12px 20px;
    font-size: 14px;
  }
}

@media (max-width: 480px) {
  .bundle-title {
    font-size: 24px;
  }

  .skin-type-options {
    flex-direction: column;
  }

  .skin-type-label {
    width: 100%;
  }

  .price-amount {
    font-size: 26px;
  }
  
  .bundle-progress {
    top: 50px;
    padding: 12px;
  }
  
  .appointment-picker-section {
    padding: 15px;
  }

  .calendar-dates {
    gap: 4px;
  }

  .calendar-date {
    font-size: 14px;
    min-height: 36px;
  }
}
</style>

<script>
// All treatment data embedded
const TREATMENT_DATA = {
  "Normal": {
    "Cleanse & Prep": [
      {"name": "Botanical Cream Cleanse", "description": "A normal-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Foaming Cleanse", "description": "A normal-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating Milk Cleanse", "description": "A normal-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Enzyme Gel Cleanse", "description": "A normal-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Gel Cleanse", "description": "A normal-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultra-Calming Cleanse", "description": "A normal-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Cream Cleanse", "description": "A normal-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Refresh Cleanse", "description": "A normal-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Exfoliate & Refine": [
      {"name": "Enzyme Powder Polish", "description": "A normal-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Lactic Acid Glow Peel", "description": "A normal-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mild AHA Resurfacing", "description": "A normal-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "PHA Gentle Exfoliation", "description": "A normal-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Salicylic Skin Refiner", "description": "A normal-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soft Peel Renewal", "description": "A normal-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Texture Smoothing Treatment", "description": "A normal-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Radiance Boost Exfoliation", "description": "A normal-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Detox & Clarify": [
      {"name": "Hydro Extraction", "description": "A normal-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Detox Mask", "description": "A normal-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Clarifying Clay Mask", "description": "A normal-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral Detox Treatment", "description": "A normal-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Purifying Boost", "description": "A normal-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Reset Mask", "description": "A normal-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Detox Gel", "description": "A normal-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Clean Clarifier", "description": "A normal-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Extract & Clear": [
      {"name": "Manual Extractions", "description": "A normal-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultrasonic Pore Cleanse", "description": "A normal-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted Congestion Clearing", "description": "A normal-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Zero-Trauma Extraction", "description": "A normal-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Pore Flush", "description": "A normal-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blackhead Softening Treatment", "description": "A normal-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Precision Clearing", "description": "A normal-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Refinement Protocol", "description": "A normal-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Boost & Infuse": [
      {"name": "Hyaluronic Infusion", "description": "A normal-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Vitamin B+C Boost", "description": "A normal-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Niacinamide Balance Shot", "description": "A normal-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ceramide Repair Ampoule", "description": "A normal-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Peptide Skin Boost", "description": "A normal-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydration Recharge Serum", "description": "A normal-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Support Infusion", "description": "A normal-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Glow Activating Complex", "description": "A normal-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Calm & Balance": [
      {"name": "Cooling Gel Mask", "description": "A normal-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Omega Nourish Mask", "description": "A normal-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Redness Relief Mask", "description": "A normal-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Calming Algae Mask", "description": "A normal-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Repair Mask", "description": "A normal-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soothing Botanical Mask", "description": "A normal-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Comfort Treatment", "description": "A normal-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Inflammation Reset Mask", "description": "A normal-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Activate & Repair": [
      {"name": "Red Light Therapy", "description": "A normal-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blue + Red LED Therapy", "description": "A normal-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Collagen Stimulating LED", "description": "A normal-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Healing Light Protocol", "description": "A normal-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Skin Activation", "description": "A normal-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Cell Renewal Therapy", "description": "A normal-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted LED Repair", "description": "A normal-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Low-Level Light Therapy", "description": "A normal-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Seal & Protect": [
      {"name": "Antioxidant Moisturiser", "description": "A normal-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating SPF Shield", "description": "A normal-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oil-Free Gel Moisturiser", "description": "A normal-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Recovery Cream", "description": "A normal-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Daily Moisturiser", "description": "A normal-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral SPF Protection", "description": "A normal-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Defence Finish", "description": "A normal-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Moisture Lock Cream", "description": "A normal-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."}
    ]
  },
  "Dry": {
    "Cleanse & Prep": [
      {"name": "Botanical Cream Cleanse", "description": "A dry-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Foaming Cleanse", "description": "A dry-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating Milk Cleanse", "description": "A dry-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Enzyme Gel Cleanse", "description": "A dry-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Gel Cleanse", "description": "A dry-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultra-Calming Cleanse", "description": "A dry-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Cream Cleanse", "description": "A dry-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Refresh Cleanse", "description": "A dry-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Exfoliate & Refine": [
      {"name": "Enzyme Powder Polish", "description": "A dry-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Lactic Acid Glow Peel", "description": "A dry-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mild AHA Resurfacing", "description": "A dry-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "PHA Gentle Exfoliation", "description": "A dry-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Salicylic Skin Refiner", "description": "A dry-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soft Peel Renewal", "description": "A dry-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Texture Smoothing Treatment", "description": "A dry-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Radiance Boost Exfoliation", "description": "A dry-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Detox & Clarify": [
      {"name": "Hydro Extraction", "description": "A dry-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Detox Mask", "description": "A dry-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Clarifying Clay Mask", "description": "A dry-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral Detox Treatment", "description": "A dry-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Purifying Boost", "description": "A dry-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Reset Mask", "description": "A dry-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Detox Gel", "description": "A dry-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Clean Clarifier", "description": "A dry-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Extract & Clear": [
      {"name": "Manual Extractions", "description": "A dry-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultrasonic Pore Cleanse", "description": "A dry-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted Congestion Clearing", "description": "A dry-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Zero-Trauma Extraction", "description": "A dry-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Pore Flush", "description": "A dry-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blackhead Softening Treatment", "description": "A dry-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Precision Clearing", "description": "A dry-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Refinement Protocol", "description": "A dry-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Boost & Infuse": [
      {"name": "Hyaluronic Infusion", "description": "A dry-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Vitamin B+C Boost", "description": "A dry-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Niacinamide Balance Shot", "description": "A dry-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ceramide Repair Ampoule", "description": "A dry-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Peptide Skin Boost", "description": "A dry-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydration Recharge Serum", "description": "A dry-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Support Infusion", "description": "A dry-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Glow Activating Complex", "description": "A dry-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Calm & Balance": [
      {"name": "Cooling Gel Mask", "description": "A dry-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Omega Nourish Mask", "description": "A dry-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Redness Relief Mask", "description": "A dry-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Calming Algae Mask", "description": "A dry-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Repair Mask", "description": "A dry-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soothing Botanical Mask", "description": "A dry-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Comfort Treatment", "description": "A dry-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Inflammation Reset Mask", "description": "A dry-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Activate & Repair": [
      {"name": "Red Light Therapy", "description": "A dry-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blue + Red LED Therapy", "description": "A dry-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Collagen Stimulating LED", "description": "A dry-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Healing Light Protocol", "description": "A dry-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Skin Activation", "description": "A dry-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Cell Renewal Therapy", "description": "A dry-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted LED Repair", "description": "A dry-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Low-Level Light Therapy", "description": "A dry-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Seal & Protect": [
      {"name": "Antioxidant Moisturiser", "description": "A dry-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating SPF Shield", "description": "A dry-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oil-Free Gel Moisturiser", "description": "A dry-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Recovery Cream", "description": "A dry-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Daily Moisturiser", "description": "A dry-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral SPF Protection", "description": "A dry-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Defence Finish", "description": "A dry-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Moisture Lock Cream", "description": "A dry-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."}
    ]
  },
  "Oily": {
    "Cleanse & Prep": [
      {"name": "Botanical Cream Cleanse", "description": "A oily-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Foaming Cleanse", "description": "A oily-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating Milk Cleanse", "description": "A oily-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Enzyme Gel Cleanse", "description": "A oily-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Gel Cleanse", "description": "A oily-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultra-Calming Cleanse", "description": "A oily-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Cream Cleanse", "description": "A oily-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Refresh Cleanse", "description": "A oily-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Exfoliate & Refine": [
      {"name": "Enzyme Powder Polish", "description": "A oily-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Lactic Acid Glow Peel", "description": "A oily-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mild AHA Resurfacing", "description": "A oily-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "PHA Gentle Exfoliation", "description": "A oily-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Salicylic Skin Refiner", "description": "A oily-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soft Peel Renewal", "description": "A oily-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Texture Smoothing Treatment", "description": "A oily-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Radiance Boost Exfoliation", "description": "A oily-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Detox & Clarify": [
      {"name": "Hydro Extraction", "description": "A oily-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Detox Mask", "description": "A oily-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Clarifying Clay Mask", "description": "A oily-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral Detox Treatment", "description": "A oily-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Purifying Boost", "description": "A oily-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Reset Mask", "description": "A oily-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Detox Gel", "description": "A oily-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Clean Clarifier", "description": "A oily-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Extract & Clear": [
      {"name": "Manual Extractions", "description": "A oily-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultrasonic Pore Cleanse", "description": "A oily-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted Congestion Clearing", "description": "A oily-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Zero-Trauma Extraction", "description": "A oily-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Pore Flush", "description": "A oily-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blackhead Softening Treatment", "description": "A oily-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Precision Clearing", "description": "A oily-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Refinement Protocol", "description": "A oily-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Boost & Infuse": [
      {"name": "Hyaluronic Infusion", "description": "A oily-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Vitamin B+C Boost", "description": "A oily-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Niacinamide Balance Shot", "description": "A oily-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ceramide Repair Ampoule", "description": "A oily-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Peptide Skin Boost", "description": "A oily-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydration Recharge Serum", "description": "A oily-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Support Infusion", "description": "A oily-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Glow Activating Complex", "description": "A oily-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Calm & Balance": [
      {"name": "Cooling Gel Mask", "description": "A oily-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Omega Nourish Mask", "description": "A oily-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Redness Relief Mask", "description": "A oily-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Calming Algae Mask", "description": "A oily-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Repair Mask", "description": "A oily-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soothing Botanical Mask", "description": "A oily-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Comfort Treatment", "description": "A oily-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Inflammation Reset Mask", "description": "A oily-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Activate & Repair": [
      {"name": "Red Light Therapy", "description": "A oily-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blue + Red LED Therapy", "description": "A oily-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Collagen Stimulating LED", "description": "A oily-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Healing Light Protocol", "description": "A oily-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Skin Activation", "description": "A oily-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Cell Renewal Therapy", "description": "A oily-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted LED Repair", "description": "A oily-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Low-Level Light Therapy", "description": "A oily-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Seal & Protect": [
      {"name": "Antioxidant Moisturiser", "description": "A oily-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating SPF Shield", "description": "A oily-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oil-Free Gel Moisturiser", "description": "A oily-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Recovery Cream", "description": "A oily-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Daily Moisturiser", "description": "A oily-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral SPF Protection", "description": "A oily-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Defence Finish", "description": "A oily-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Moisture Lock Cream", "description": "A oily-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."}
    ]
  },
  "Combination": {
    "Cleanse & Prep": [
      {"name": "Botanical Cream Cleanse", "description": "A combination-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Foaming Cleanse", "description": "A combination-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating Milk Cleanse", "description": "A combination-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Enzyme Gel Cleanse", "description": "A combination-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Gel Cleanse", "description": "A combination-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultra-Calming Cleanse", "description": "A combination-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Cream Cleanse", "description": "A combination-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Refresh Cleanse", "description": "A combination-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Exfoliate & Refine": [
      {"name": "Enzyme Powder Polish", "description": "A combination-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Lactic Acid Glow Peel", "description": "A combination-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mild AHA Resurfacing", "description": "A combination-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "PHA Gentle Exfoliation", "description": "A combination-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Salicylic Skin Refiner", "description": "A combination-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soft Peel Renewal", "description": "A combination-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Texture Smoothing Treatment", "description": "A combination-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Radiance Boost Exfoliation", "description": "A combination-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Detox & Clarify": [
      {"name": "Hydro Extraction", "description": "A combination-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Detox Mask", "description": "A combination-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Clarifying Clay Mask", "description": "A combination-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral Detox Treatment", "description": "A combination-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Purifying Boost", "description": "A combination-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Reset Mask", "description": "A combination-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Detox Gel", "description": "A combination-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Clean Clarifier", "description": "A combination-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Extract & Clear": [
      {"name": "Manual Extractions", "description": "A combination-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultrasonic Pore Cleanse", "description": "A combination-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted Congestion Clearing", "description": "A combination-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Zero-Trauma Extraction", "description": "A combination-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Pore Flush", "description": "A combination-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blackhead Softening Treatment", "description": "A combination-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Precision Clearing", "description": "A combination-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Refinement Protocol", "description": "A combination-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Boost & Infuse": [
      {"name": "Hyaluronic Infusion", "description": "A combination-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Vitamin B+C Boost", "description": "A combination-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Niacinamide Balance Shot", "description": "A combination-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ceramide Repair Ampoule", "description": "A combination-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Peptide Skin Boost", "description": "A combination-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydration Recharge Serum", "description": "A combination-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Support Infusion", "description": "A combination-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Glow Activating Complex", "description": "A combination-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Calm & Balance": [
      {"name": "Cooling Gel Mask", "description": "A combination-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Omega Nourish Mask", "description": "A combination-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Redness Relief Mask", "description": "A combination-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Calming Algae Mask", "description": "A combination-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Repair Mask", "description": "A combination-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soothing Botanical Mask", "description": "A combination-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Comfort Treatment", "description": "A combination-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Inflammation Reset Mask", "description": "A combination-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Activate & Repair": [
      {"name": "Red Light Therapy", "description": "A combination-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blue + Red LED Therapy", "description": "A combination-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Collagen Stimulating LED", "description": "A combination-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Healing Light Protocol", "description": "A combination-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Skin Activation", "description": "A combination-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Cell Renewal Therapy", "description": "A combination-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted LED Repair", "description": "A combination-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Low-Level Light Therapy", "description": "A combination-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Seal & Protect": [
      {"name": "Antioxidant Moisturiser", "description": "A combination-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating SPF Shield", "description": "A combination-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oil-Free Gel Moisturiser", "description": "A combination-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Recovery Cream", "description": "A combination-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Daily Moisturiser", "description": "A combination-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral SPF Protection", "description": "A combination-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Defence Finish", "description": "A combination-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Moisture Lock Cream", "description": "A combination-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."}
    ]
  },
  "Sensitive": {
    "Cleanse & Prep": [
      {"name": "Botanical Cream Cleanse", "description": "A sensitive-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Foaming Cleanse", "description": "A sensitive-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating Milk Cleanse", "description": "A sensitive-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Enzyme Gel Cleanse", "description": "A sensitive-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Gel Cleanse", "description": "A sensitive-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultra-Calming Cleanse", "description": "A sensitive-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Cream Cleanse", "description": "A sensitive-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Refresh Cleanse", "description": "A sensitive-skin suitable option within the cleanse & prep stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Exfoliate & Refine": [
      {"name": "Enzyme Powder Polish", "description": "A sensitive-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Lactic Acid Glow Peel", "description": "A sensitive-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mild AHA Resurfacing", "description": "A sensitive-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "PHA Gentle Exfoliation", "description": "A sensitive-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Salicylic Skin Refiner", "description": "A sensitive-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soft Peel Renewal", "description": "A sensitive-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Texture Smoothing Treatment", "description": "A sensitive-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Radiance Boost Exfoliation", "description": "A sensitive-skin suitable option within the exfoliate & refine stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Detox & Clarify": [
      {"name": "Hydro Extraction", "description": "A sensitive-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Charcoal Detox Mask", "description": "A sensitive-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Clarifying Clay Mask", "description": "A sensitive-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral Detox Treatment", "description": "A sensitive-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Purifying Boost", "description": "A sensitive-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Reset Mask", "description": "A sensitive-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Detox Gel", "description": "A sensitive-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Clean Clarifier", "description": "A sensitive-skin suitable option within the detox & clarify stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Extract & Clear": [
      {"name": "Manual Extractions", "description": "A sensitive-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ultrasonic Pore Cleanse", "description": "A sensitive-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted Congestion Clearing", "description": "A sensitive-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Zero-Trauma Extraction", "description": "A sensitive-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Deep Pore Flush", "description": "A sensitive-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blackhead Softening Treatment", "description": "A sensitive-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Precision Clearing", "description": "A sensitive-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Pore Refinement Protocol", "description": "A sensitive-skin suitable option within the extract & clear stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Boost & Infuse": [
      {"name": "Hyaluronic Infusion", "description": "A sensitive-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Vitamin B+C Boost", "description": "A sensitive-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Niacinamide Balance Shot", "description": "A sensitive-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Ceramide Repair Ampoule", "description": "A sensitive-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Peptide Skin Boost", "description": "A sensitive-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydration Recharge Serum", "description": "A sensitive-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Support Infusion", "description": "A sensitive-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Glow Activating Complex", "description": "A sensitive-skin suitable option within the boost & infuse stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Calm & Balance": [
      {"name": "Cooling Gel Mask", "description": "A sensitive-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Omega Nourish Mask", "description": "A sensitive-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Redness Relief Mask", "description": "A sensitive-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Calming Algae Mask", "description": "A sensitive-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Repair Mask", "description": "A sensitive-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Soothing Botanical Mask", "description": "A sensitive-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Comfort Treatment", "description": "A sensitive-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Inflammation Reset Mask", "description": "A sensitive-skin suitable option within the calm & balance stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Activate & Repair": [
      {"name": "Red Light Therapy", "description": "A sensitive-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Blue + Red LED Therapy", "description": "A sensitive-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Collagen Stimulating LED", "description": "A sensitive-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Healing Light Protocol", "description": "A sensitive-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oxygen Skin Activation", "description": "A sensitive-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Cell Renewal Therapy", "description": "A sensitive-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Targeted LED Repair", "description": "A sensitive-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Low-Level Light Therapy", "description": "A sensitive-skin suitable option within the activate & repair stage, designed to support skin health while delivering visible comfort and results."}
    ],
    "Seal & Protect": [
      {"name": "Antioxidant Moisturiser", "description": "A sensitive-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Hydrating SPF Shield", "description": "A sensitive-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Oil-Free Gel Moisturiser", "description": "A sensitive-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Barrier Recovery Cream", "description": "A sensitive-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Balancing Daily Moisturiser", "description": "A sensitive-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Mineral SPF Protection", "description": "A sensitive-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Skin Defence Finish", "description": "A sensitive-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."},
      {"name": "Moisture Lock Cream", "description": "A sensitive-skin suitable option within the seal & protect stage, designed to support skin health while delivering visible comfort and results."}
    ]
  }
};

document.addEventListener('DOMContentLoaded', function() {
  initFacialBundle();
});

// Support for Shopify theme customizer
if (typeof Shopify !== 'undefined' && Shopify.designMode) {
  document.addEventListener('shopify:section:load', function() {
    setTimeout(initFacialBundle, 100);
  });
}

function initFacialBundle() {
  const bundle = document.querySelector('.facial-bundle');
  if (!bundle) {
    setTimeout(initFacialBundle, 100);
    return;
  }

  let selectedSkinType = null;
  let selectedTreatments = {}; // { bucket: treatmentName }
  let selectedAppointmentDate = null;
  let selectedAppointmentTime = null;
  const variantId = '{{ section.settings.variant_id }}';

  // Appointment picker variables
  let currentMonth = new Date().getMonth();
  let currentYear = new Date().getFullYear();
  let appointmentDate = null;
  let appointmentTime = null;

  // Get appointment settings from section
  const defaultSlotsText = `{{ section.settings.default_slots }}`;
  const saturdaySlotsText = `{{ section.settings.saturday_slots }}`;
  const customDatesText = `{{ section.settings.custom_dates }}`;

  // Parse time slots
  const defaultSlots = defaultSlotsText.split('\n').map(s => s.trim()).filter(s => s);
  const saturdaySlots = saturdaySlotsText.split('\n').map(s => s.trim()).filter(s => s);

  // Parse custom dates blocking
  const CUSTOM_DATES = {};
  if (customDatesText.trim()) {
    customDatesText.split('\n').forEach(line => {
      line = line.trim();
      if (!line) return;
      const [date, slotsStr] = line.split('|');
      if (slotsStr === 'CLOSED') {
        CUSTOM_DATES[date.trim()] = 'CLOSED';
      } else {
        CUSTOM_DATES[date.trim()] = slotsStr.split(',').map(s => s.trim());
      }
    });
  }

  // Handle skin type selection
  document.querySelectorAll('.skin-type-radio').forEach(radio => {
    radio.addEventListener('change', function() {
      if (this.checked) {
        selectedSkinType = this.value;
        selectedTreatments = {}; // Reset selections
        loadTreatments(selectedSkinType);
        showAllSections();
      }
    });
  });

  // Show all sections after skin type selection
  function showAllSections() {
    document.getElementById('selectionNotice').style.display = 'block';
    document.getElementById('progressSection').style.display = 'block';
    document.getElementById('treatmentCategories').style.display = 'block';
    document.getElementById('appointmentSection').style.display = 'block';
    document.getElementById('bundleFooter').style.display = 'block';
    
    // Initialize appointment picker
    initializeAppointmentPicker();
    
    // Add scroll listener for sticky progress bar effect
    window.addEventListener('scroll', function() {
      const progressBar = document.getElementById('progressSection');
      if (progressBar) {
        if (window.scrollY > 100) {
          progressBar.classList.add('scrolled');
        } else {
          progressBar.classList.remove('scrolled');
        }
      }
    });
  }
  function loadTreatments(skinType) {
    const data = TREATMENT_DATA[skinType];
    
    document.querySelectorAll('.category-wrapper').forEach(category => {
      const bucket = category.dataset.bucket;
      const optionsContainer = category.querySelector('.category-options');
      const treatments = data[bucket];
      
      // Clear existing options
      optionsContainer.innerHTML = '';
      
      // Add treatment options
      treatments.forEach((treatment, index) => {
        const optionHtml = `
          <label class="treatment-option">
            <input 
              type="radio" 
              class="treatment-radio" 
              name="treatment_${bucket.replace(/\s+/g, '_')}"
              data-bucket="${bucket}"
              data-treatment="${treatment.name}"
            >
            <div class="treatment-content">
              <span class="treatment-name">${treatment.name}</span>
              <p class="treatment-description">${treatment.description}</p>
            </div>
            <span class="treatment-checkmark">âœ“</span>
          </label>
        `;
        optionsContainer.insertAdjacentHTML('beforeend', optionHtml);
      });

      // Add event listeners to new radios
      optionsContainer.querySelectorAll('.treatment-radio').forEach(radio => {
        radio.addEventListener('change', function() {
          if (this.checked) {
            const bucket = this.dataset.bucket;
            const treatment = this.dataset.treatment;
            selectedTreatments[bucket] = treatment;
            updateCategoryStatus(bucket);
            updateProgress();
          }
        });
      });
    });
  }

  // Show treatment sections
  function showTreatmentSections() {
    document.getElementById('selectionNotice').style.display = 'block';
    document.getElementById('progressSection').style.display = 'block';
    document.getElementById('treatmentCategories').style.display = 'block';
    document.getElementById('bundleFooter').style.display = 'block';
    
    // Add scroll listener for sticky progress bar effect
    window.addEventListener('scroll', function() {
      const progressBar = document.getElementById('progressSection');
      if (progressBar) {
        if (window.scrollY > 100) {
          progressBar.classList.add('scrolled');
        } else {
          progressBar.classList.remove('scrolled');
        }
      }
    });
  }

  // Update category status
  function updateCategoryStatus(bucket) {
    const category = document.querySelector(`[data-bucket="${bucket}"]`);
    const statusSpan = category.querySelector('.category-status');
    
    if (selectedTreatments[bucket]) {
      category.classList.add('completed');
      statusSpan.textContent = 'âœ“ Selected';
    } else {
      category.classList.remove('completed');
      statusSpan.textContent = 'Not selected';
    }
  }

  // Update progress
  function updateProgress() {
    const count = Object.keys(selectedTreatments).length;
    const progressFill = document.getElementById('progressFill');
    const progressCount = document.getElementById('progressCount');
    const selectionsInfo = document.getElementById('selectionsInfo');
    const addToCartBtn = document.getElementById('addToCartBtn');
    
    // Update progress bar
    const percentage = (count / 8) * 100;
    progressFill.style.width = percentage + '%';
    
    // Update count text
    progressCount.textContent = `${count} / 8 treatments selected`;
    
    // Update selections info
    if (count === 0) {
      selectionsInfo.textContent = 'Select 1 treatment from each category';
    } else if (count < 8) {
      selectionsInfo.textContent = `${8 - count} more ${(8 - count) === 1 ? 'treatment' : 'treatments'} needed`;
    } else {
      selectionsInfo.textContent = 'âœ“ Bundle complete! Ready to add to cart';
    }
    
    // Enable/disable add to cart button
    addToCartBtn.disabled = count !== 8;
  }

  // Handle category expand/collapse
  document.querySelectorAll('.category-header').forEach(header => {
    header.addEventListener('click', function() {
      const category = this.closest('.category-wrapper');
      category.classList.toggle('collapsed');
    });
  });

  // Initialize Appointment Picker
  function initializeAppointmentPicker() {
    const dropdown = document.getElementById('appointmentDropdown');
    const display = document.getElementById('appointmentDisplay');
    const modal = document.getElementById('appointmentModal');
    const closeBtn = document.getElementById('closeModal');
    const cancelBtn = document.getElementById('cancelBtn');
    const confirmBtn = document.getElementById('confirmBtn');

    // Open modal
    dropdown.addEventListener('click', () => {
      modal.classList.add('active');
      renderCalendar();
    });

    // Close modal
    function closeModal() {
      modal.classList.remove('active');
    }

    closeBtn.addEventListener('click', closeModal);
    cancelBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeModal();
    });

    // Month navigation
    document.getElementById('prevMonth').addEventListener('click', () => {
      currentMonth--;
      if (currentMonth < 0) { currentMonth = 11; currentYear--; }
      renderCalendar();
    });

    document.getElementById('nextMonth').addEventListener('click', () => {
      currentMonth++;
      if (currentMonth > 11) { currentMonth = 0; currentYear++; }
      renderCalendar();
    });

    // Render calendar
    function renderCalendar() {
      const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
      document.getElementById('monthYear').textContent = `${months[currentMonth]} ${currentYear}`;
      
      const container = document.getElementById('calendarDates');
      container.innerHTML = '';
      
      const firstDay = new Date(currentYear, currentMonth, 1).getDay();
      const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
      const today = new Date();
      today.setHours(0,0,0,0);
      
      const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1;
      const closedDays = [0, 1, 4]; // Sunday, Monday, Thursday closed
      
      for (let i = 0; i < adjustedFirstDay; i++) {
        container.innerHTML += '<div class="calendar-date"></div>';
      }
      
      for (let day = 1; day <= daysInMonth; day++) {
        const date = new Date(currentYear, currentMonth, day);
        date.setHours(0,0,0,0);
        const dayOfWeek = date.getDay();
        const dateStr = `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
        
        let classes = 'calendar-date';
        if (date < today) classes += ' past';
        else if (closedDays.includes(dayOfWeek)) classes += ' disabled';
        else if (CUSTOM_DATES[dateStr] === 'CLOSED') classes += ' disabled'; // Custom closed date
        else if (date.getTime() === today.getTime()) classes += ' today';
        if (appointmentDate && date.getTime() === appointmentDate.getTime()) classes += ' selected';
        
        const dateEl = document.createElement('div');
        dateEl.className = classes;
        dateEl.textContent = day;
        if (!classes.includes('past') && !classes.includes('disabled')) {
          dateEl.addEventListener('click', () => selectDate(date));
        }
        container.appendChild(dateEl);
      }
    }

    // Select date
    function selectDate(date) {
      appointmentDate = date;
      appointmentTime = null;
      renderCalendar();
      updateTimeSlots(date);
      confirmBtn.disabled = true;
    }

    // Update time slots
    function updateTimeSlots(date) {
      const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
      const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
      document.getElementById('timeHeader').textContent = 
        `${days[date.getDay()]}, ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
      
      const dateStr = `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
      
      // Start with default slots based on day of week
      let slots = date.getDay() === 6 ? [...saturdaySlots] : [...defaultSlots];
      
      // Check if this date has custom blocking rules
      if (CUSTOM_DATES[dateStr]) {
        if (CUSTOM_DATES[dateStr] === 'CLOSED') {
          // If marked as CLOSED, show no slots
          document.getElementById('timeSlots').innerHTML = 
            '<div style="padding:20px;text-align:center;color:#999">No appointments available on this date</div>';
          return;
        } else {
          // Block/remove specific times from the list
          const blockedTimes = CUSTOM_DATES[dateStr];
          slots = slots.filter(time => !blockedTimes.includes(time));
        }
      }
      
      const container = document.getElementById('timeSlots');
      container.innerHTML = '';
      
      if (slots.length === 0) {
        container.innerHTML = '<div style="padding:20px;text-align:center;color:#999">No available time slots</div>';
        return;
      }
      
      slots.forEach(time => {
        const el = document.createElement('div');
        el.className = 'time-slot-option';
        el.innerHTML = `<span>${time}</span><div class="time-slot-radio"></div>`;
        el.addEventListener('click', () => selectTime(time, el));
        container.appendChild(el);
      });
    }

    // Select time
    function selectTime(time, el) {
      document.querySelectorAll('#timeSlots .time-slot-option').forEach(s => s.classList.remove('selected'));
      el.classList.add('selected');
      appointmentTime = time;
      confirmBtn.disabled = false;
      
      // Auto-scroll to show confirm button
      setTimeout(() => {
        const modalContent = document.querySelector('.appointment-modal-content');
        if (modalContent) {
          modalContent.scrollTo({
            top: modalContent.scrollHeight,
            behavior: 'smooth'
          });
        }
      }, 100);
    }

    // Confirm appointment
    confirmBtn.addEventListener('click', () => {
      if (!appointmentDate || !appointmentTime) return;
      
      const formattedDate = appointmentDate.toLocaleDateString('en-US', { 
        month: 'long', 
        day: 'numeric', 
        year: 'numeric' 
      });
      
      display.textContent = `${formattedDate} at ${appointmentTime}`;
      selectedAppointmentDate = formattedDate;
      selectedAppointmentTime = appointmentTime;
      
      closeModal();
    });

    renderCalendar();
  }

  // Handle category expand/collapse (moved up for organization)
  document.querySelectorAll('.category-header').forEach(header => {
    header.addEventListener('click', function() {
      const category = this.closest('.category-wrapper');
      category.classList.toggle('collapsed');
    });
  });

  // Handle add to cart
  document.getElementById('addToCartBtn').addEventListener('click', function() {
    if (Object.keys(selectedTreatments).length !== 8) {
      alert('Please select 1 treatment from each of the 8 categories.');
      return;
    }

    if (!selectedAppointmentDate || !selectedAppointmentTime) {
      alert('Please select an appointment date and time.');
      return;
    }

    if (!variantId) {
      alert('Product configuration error. Please contact support.');
      return;
    }

    // Build line item properties
    const properties = {
      'Skin Type': selectedSkinType,
      'Appointment Date': selectedAppointmentDate,
      'Appointment Time': selectedAppointmentTime
    };
    
    let index = 1;
    const buckets = [
      'Cleanse & Prep',
      'Exfoliate & Refine',
      'Detox & Clarify',
      'Extract & Clear',
      'Boost & Infuse',
      'Calm & Balance',
      'Activate & Repair',
      'Seal & Protect'
    ];
    
    buckets.forEach(bucket => {
      if (selectedTreatments[bucket]) {
        properties[`${index}. ${bucket}`] = selectedTreatments[bucket];
        index++;
      }
    });

    // Add to cart
    fetch('/cart/add.js', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        id: variantId,
        quantity: 1,
        properties: properties
      })
    })
    .then(response => response.json())
    .then(data => {
      window.location.href = '/cart';
    })
    .catch(error => {
      console.error('Error:', error);
      alert('There was an error adding to cart. Please try again.');
    });
  });
}
</script>

{% schema %}
{
  "name": "8x8 Facial Bundle",
  "settings": [
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Build Your Custom Facial Treatment Bundle"
    },
    {
      "type": "textarea",
      "id": "section_description",
      "label": "Section Description",
      "default": "Create your perfect 8-step facial treatment. Select your skin type, then choose 1 treatment from each of our 8 specialized categories for a completely customized experience."
    },
    {
      "type": "text",
      "id": "variant_id",
      "label": "Product Variant ID",
      "info": "The variant ID for the $99.99 bundle product"
    },
    {
      "type": "header",
      "content": "âš™ï¸ Appointment Settings"
    },
    {
      "type": "textarea",
      "id": "default_slots",
      "label": "Default Time Slots (Regular Days)",
      "info": "One time per line. Example: 10:00 AM",
      "default": "9:00 AM\n9:30 AM\n10:00 AM\n10:30 AM\n11:00 AM\n11:30 AM\n12:00 PM\n12:30 PM\n1:00 PM\n1:30 PM\n2:00 PM\n2:30 PM\n3:00 PM\n3:30 PM\n4:00 PM\n4:30 PM\n5:00 PM"
    },
    {
      "type": "textarea",
      "id": "saturday_slots",
      "label": "Saturday Time Slots",
      "info": "One time per line",
      "default": "9:00 AM\n9:30 AM\n10:00 AM\n10:30 AM\n11:00 AM\n11:30 AM\n12:00 PM\n12:30 PM\n1:00 PM"
    },
    {
      "type": "textarea",
      "id": "custom_dates",
      "label": "Custom Dates (Block Specific Times)",
      "info": "Block times on specific dates. Format: 2025-12-25|CLOSED (closes entire day) or 2025-12-31|10:00 AM,2:00 PM (removes only those times)"
    }
  ],
  "presets": [
    {
      "name": "8x8 Facial Bundle"
    }
  ]
}
{% endschema %}
